<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style></style>
  </head>
  <body style="background-color:#ffffff; margin: 0px">
    <center>
      <table style="width: 100%;background-color:#ffffff; border-spacing: 0px">
        <tr style="width: 100%; height:100px;background-color:#656CEC;">
          <th colspan="4" style="font-size:64px;color:#ffffff;font-family:'Segoe UI';">Leaderboard</th>
        </tr>
        <tr style="width:100%; height:4px;"></tr>
        <tr style="width: 100%; height:347px;background-color:#656CEC;">
          <td colspan="4" style=" border-radius: 0px 0px 64px 64px;" id="winners">
            
          </td>
        </tr>
        <tr style="width:100%; height:23px;"></tr>
      </table>
      <table style="width: 100%;background-color:#ffffff; border-spacing: 0px" id="score_list">
      </table>
    </center>

    <script>
      // api url
      const api_url =
      "https://www.coursehubiitg.in/api/codingweek/contributions";

      // Defining async function
      async function getapi(url) {

        // Storing response
        const response = await fetch(url);

        // Storing data in form of JSON
        var data = await response.json();
        
        // Sort by points
        data.sort((a, b) => b.points - a.points);
        console.log(data);

        show(data);
      }

      // Calling that async function
      getapi(api_url);

      // Function to define innerHTML for HTML table
      function show(data) {
      let header = `<div style="
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: flex-end;">
        <div style="display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;">
          <div style="border-radius: 50%;
            background:#BABEFF ;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center; margin-bottom: 5px;color:white;font-size: 24px;">2</div>
          <div style="width: 160px;
            height: 160px;
            border-radius: 50%;
            background: rgb(255, 255, 255);
             display: flex;
             justify-content: center;
             align-items: center; padding: 6px; margin-inline: 50px;">
            <div style="width: 100%;
              height: 100%;
              border-radius: 50%;
              background: rgb(186, 190, 255);
              display: flex;
              justify-content: center;
              align-items: center; background-position: center;
              background-repeat: no-repeat;
              background-size: contain; background-image: url('${data[1]['avatar']}');">
            </div>
          </div>
          <div style="margin-top: 5px;
padding: 10px 30px;
background: rgb(186, 190, 255);
border-radius: 20px; font-size: 16px; color: white;font-family: Inter;">${data[1]['name']} - ${data[1]['points']}</div>
        </div>
        <div style="display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;">
          <div style="border-radius: 50%;
            background: #BABEFF;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center; margin-bottom: 5px;color:white;font-size: 24px;">1</div>
            <div style="width: 214.86px;
                  height: 214.86px;
                  border-radius: 50%;
                  background: rgb(255, 255, 255);
                  display: flex;
                  justify-content: center;
                  align-items: center; padding: 6px; margin-inline: 50px;">
                  <div style="width: 100%;
                    height: 100%;
                    border-radius: 50%;
                    background: rgb(186, 190, 255);
                    display: flex;
                    justify-content: center;
                    align-items: center; background-position: center;
              background-repeat: no-repeat;
              background-size: contain; background-image: url('${data[0]['avatar']}');">
            </div>
          </div>
          <div style="margin-top: 5px;
padding: 10px 30px;
background: rgb(186, 190, 255);
border-radius: 20px; font-size: 16px; color: white;">${data[0]['name']} - ${data[0]['points']}</div>
        </div>
        <div style="display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;">
          <div style="border-radius: 50%;
            background:#BABEFF ;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center; margin-bottom: 5px;color:white;font-size: 24px;">3</div>
            <div style="width: 160px;
                  height: 160px;
                  border-radius: 50%;
                  background: rgb(255, 255, 255);
                  display: flex;
                  justify-content: center;
                  align-items: center; padding: 6px; margin-inline: 50px;">
                  <div style="width: 100%;
                    height: 100%;
                    border-radius: 50%;
                    background: rgb(186, 190, 255);
                    display: flex;
                    justify-content: center;
                    align-items: center; background-position: center;
              background-repeat: no-repeat;
              background-size: contain; background-image: url('${data[2]['avatar']}');">
            </div>
          </div>
          <div style="margin-top: 5px;
padding: 10px 30px;
background: rgb(186, 190, 255);
border-radius: 20px; font-size: 16px; color: white;">${data[2]['name']} - ${data[2]['points']}</div>
        </div>
      </div>`;
        let tab = ``;

      // Loop to access all rows
      let i = 3;
      let total = data.length;
      while (i < total) {
        tab += `<tr style="width: 100%; height:100px;background-color:#D2D4F2;">
          <td style="width:10%;font-size:36px; text-align: center;font-family:Inter;">${i+1}</td>
          <td style="width:10%">
            <div style="width: 80px;
            height: 80px;
            border-radius: 50%;
            background: rgb(255, 255, 255);
            display: flex;
                  align-items: center;
                  justify-content: center;">
              <div style="width: 74.42px; height: 74.42px; border-radius: 50%; background-position: center;
              background-repeat: no-repeat;
              background-size: contain; background-image: url('${data[i]['avatar']}');">                
              </div>
            </div>
          </td>
          <td style="width:40%;font-size:36px;font-family:Inter; text-align: left; padding-left: 20px;">${data[i]['name']}</td>
          <td style="width:40%;font-size:36px;font-family:Inter; text-align: center;">${data[i]['points']}</td>
        </tr>
        <tr style="background: white; height: 10px;"></tr>`
        i += 1;
      }
      // Setting innerHTML as tab variable
      document.getElementById("score_list").innerHTML = tab;
      document.getElementById("winners").innerHTML = header;
      }

    </script>
  </body>
</html>
